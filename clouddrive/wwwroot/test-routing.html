<!DOCTYPE html>
<html>
<head>
    <title>CloudDrive URL Routing Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .test-link { display: block; margin: 5px 0; padding: 8px; background: #f0f0f0; text-decoration: none; color: #333; border-radius: 3px; }
        .test-link:hover { background: #e0e0e0; }
        .current-url { background: #ffffcc; padding: 10px; border-radius: 3px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>CloudDrive URL Routing Test Page</h1>
    
    <div class="test-section">
        <h2>Current URL:</h2>
        <div id="currentUrl" class="current-url"></div>
        <p><strong>Expected behavior:</strong> When you click any link below, the URL should change and the app should navigate to that page/view.</p>
        <p><strong>Debugging:</strong> Check browser console for navigation events and ViewService state changes.</p>
    </div>

    <div class="test-section">
        <h2>Basic Page Navigation</h2>
        <a href="/?page=dashboard" class="test-link">Dashboard</a>
        <a href="/?page=files" class="test-link">Files</a>
        <a href="/?page=tasks" class="test-link">Tasks</a>
        <a href="/?page=backups" class="test-link">Backups</a>
        <a href="/?page=cloudstorages" class="test-link">Cloud Storages</a>
        <a href="/?page=mounts" class="test-link">Mounts</a>
        <a href="/?page=settings" class="test-link">Settings</a>
    </div>

    <div class="test-section">
        <h2>Files with Path Navigation</h2>
        <a href="/?page=files" class="test-link">Files - Root (/?page=files)</a>
        <a href="/?page=files&path=/" class="test-link">Files - Root with path (/?page=files&path=/)</a>
        <a href="/?page=files&path=/Documents" class="test-link">Files - Documents (/?page=files&path=/Documents)</a>
        <a href="/?page=files&path=/Documents/Photos" class="test-link">Files - Documents/Photos (/?page=files&path=/Documents/Photos)</a>
        <a href="/?page=files&path=/Downloads" class="test-link">Files - Downloads (/?page=files&path=/Downloads)</a>
        <p><em>Legacy format (should still work):</em></p>
        <a href="/?path=/Documents" class="test-link">Legacy - Documents (/?path=/Documents)</a>
        <a href="/?path=/Downloads" class="test-link">Legacy - Downloads (/?path=/Downloads)</a>
    </div>

    <div class="test-section">
        <h2>Tasks with Tab Navigation</h2>
        <a href="/?page=tasks&tab=copy" class="test-link">Tasks - Copy/Move</a>
        <a href="/?page=tasks&tab=upload" class="test-link">Tasks - Upload</a>
        <a href="/?page=tasks&tab=download" class="test-link">Tasks - Download</a>
    </div>

    <div class="test-section">
        <h2>JavaScript Navigation (Open Browser Console)</h2>
        <button onclick="testJS()">Test JavaScript Navigation</button>
        <p><em>Check the browser console for test results and try the nav.* commands manually.</em></p>
    </div>

    <script>
        // Update current URL display
        function updateCurrentUrl() {
            document.getElementById('currentUrl').textContent = window.location.href;
        }

        // JavaScript navigation test
        function testJS() {
            console.log('CloudDrive Navigation API Test');
            console.log('===============================');
            
            if (typeof nav !== 'undefined') {
                console.log('✓ Navigation API loaded successfully');
                console.log('Available methods:', Object.getOwnPropertyNames(nav));
                
                console.log('\nTesting navigation methods:');
                console.log('nav.goToTasks() - Navigate to tasks');
                console.log('nav.goToCopyTasks() - Navigate to copy tasks');
                console.log('nav.goToUploadTasks() - Navigate to upload tasks');
                console.log('nav.goToDownloadTasks() - Navigate to download tasks');
                console.log('nav.goToFiles("/Documents") - Navigate to Documents folder');
                console.log('nav.goToBackups() - Navigate to backups');
                
                console.log('\nCurrent URL parameters:');
                console.log(nav.getQueryParams());
                
                console.log('\nTry running any of the nav.* commands above!');
            } else {
                console.error('✗ Navigation API not loaded. Make sure navigation.js is included.');
            }
        }

        // Update URL display on page load and when URL changes
        updateCurrentUrl();
        window.addEventListener('popstate', updateCurrentUrl);
        
        // Listen for URL changes from navigation API
        window.addEventListener('blazor-navigation', function(e) {
            console.log('Navigation event:', e.detail);
            setTimeout(updateCurrentUrl, 100); // Small delay to let URL update
        });
    </script>
</body>
</html>
