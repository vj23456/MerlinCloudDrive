<!DOCTYPE html>
<html>
<head>
    <title>Header Responsive Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3b82f6;
            --bg-primary: #ffffff;
            --bg-hover: #f3f4f6;
            --text-primary: #1f2937;
            --border-color: #d1d5db;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            padding: 0 1.25rem;
            gap: 0.75rem;
            min-height: 56px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
        }
        
        .header-status-section {
            flex: 1 1 auto;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            min-width: 0;
            overflow: hidden;
        }
        
        .header-view-section {
            flex: 0 0 auto;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            min-width: 140px;
        }
        
        .action-buttons, .selection-actions {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            flex-shrink: 0;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            border: none !important;
            background: transparent !important;
            color: var(--text-primary);
            transition: background-color 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
            cursor: pointer;
        }
        
        .btn:hover {
            background: var(--bg-hover) !important;
        }
        
        .btn-outline-primary { color: var(--primary-color); }
        .btn-outline-danger { color: #ef4444; }
        .btn-outline-warning { color: #f59e0b; }
        .btn-outline-info { color: #3b82f6; }
        
        #overflow-menu {
            display: none;
            flex-shrink: 0;
            margin-left: 0.25rem;
        }
        
        .header-controls.responsive #overflow-menu {
            display: block;
        }
        
        .dropdown-menu {
            min-width: 200px;
            max-width: 300px;
            z-index: 1070;
            position: absolute;
            top: 100%;
            left: 0;
            transform: translateY(2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
        }
        
        .dropdown-item {
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-primary);
            text-decoration: none;
            background: transparent;
            border: none;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .dropdown-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        
        .view-controls {
            display: flex;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            background: var(--bg-primary);
        }
        
        .view-btn {
            border: none;
            background: transparent;
            color: var(--text-primary);
            padding: 0.6rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 500;
            border-radius: 0;
        }
        
        .view-btn:hover {
            background: var(--bg-hover);
        }
        
        .view-btn.active {
            background: var(--primary-color);
            color: white;
        }
        
        .info-btn {
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 0.6rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .info-btn:hover {
            background: var(--bg-hover);
        }
    </style>
</head>
<body>
    <div class="p-4">
        <h3>Header Responsive Test</h3>
        <p>Resize the window to see the responsive behavior. Buttons will be hidden from right to left and appear in the "More Actions" dropdown.</p>
        
        <div class="header-controls" id="header-controls">
            <div class="header-status-section" id="header-status-section">
                <div class="action-buttons">
                    <button type="button" class="btn btn-outline-primary btn-sm" id="add-cloud-storage-btn">
                        <i class="fas fa-plus"></i>
                        <span>Add Storage</span>
                    </button>
                    <button type="button" class="btn btn-outline-info btn-sm" id="refresh-btn">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                    <button type="button" class="btn btn-outline-info btn-sm" id="search-btn">
                        <i class="fas fa-search"></i>
                        <span>Search</span>
                    </button>
                </div>
                <div class="selection-actions">
                    <button class="btn btn-outline-primary btn-sm" id="download-selected-btn">
                        <i class="fas fa-download"></i>
                        <span>Download</span>
                    </button>
                    <button class="btn btn-outline-warning btn-sm" id="rename-selected-btn">
                        <i class="fas fa-edit"></i>
                        <span>Rename</span>
                    </button>
                    <button class="btn btn-outline-info btn-sm" id="move-to-btn">
                        <i class="fas fa-people-carry"></i>
                        <span>Move/Copy</span>
                    </button>
                    <button class="btn btn-outline-danger btn-sm" id="delete-selected-btn">
                        <i class="fas fa-trash"></i>
                        <span>Delete</span>
                    </button>
                </div>
                
                <!-- Overflow Menu -->
                <div class="btn-group" role="group" id="overflow-menu">
                    <button type="button" class="btn btn-outline-primary btn-sm dropdown-toggle" 
                            data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-plus me-2"></i>Add Storage</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-sync-alt me-2"></i>Refresh</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-search me-2"></i>Search</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-download me-2"></i>Download</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-edit me-2"></i>Rename</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-people-carry me-2"></i>Move/Copy</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-trash me-2"></i>Delete</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="header-view-section">
                <div class="view-controls">
                    <button class="view-btn active">
                        <i class="fas fa-th-large"></i>
                    </button>
                    <button class="view-btn">
                        <i class="fas fa-list"></i>
                    </button>
                    <button class="view-btn">
                        <i class="fas fa-images"></i>
                    </button>
                </div>
                <button class="info-btn">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </div>
        
        <div class="mt-3">
            <button onclick="toggleButton('add-cloud-storage-btn')">Toggle Add Storage</button>
            <button onclick="toggleButton('refresh-btn')">Toggle Refresh</button>
            <button onclick="toggleButton('search-btn')">Toggle Search</button>
            <button onclick="toggleButton('download-selected-btn')">Toggle Download</button>
            <button onclick="toggleButton('rename-selected-btn')">Toggle Rename</button>
            <button onclick="toggleButton('move-to-btn')">Toggle Move/Copy</button>
            <button onclick="toggleButton('delete-selected-btn')">Toggle Delete</button>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="responsive-header-helper.js"></script>
    <script>
        // Mock Blazor component reference
        const mockDotNetRef = {
            invokeMethodAsync: function(method, ...args) {
                console.log(`Mock Blazor call: ${method}`, args);
                return Promise.resolve();
            }
        };
        
        // Initialize the responsive header helper
        responsiveHeaderHelper.initialize(mockDotNetRef);
        
        // Function to toggle button visibility for testing
        function toggleButton(buttonId) {
            const button = document.getElementById(buttonId);
            if (button) {
                const isHidden = button.style.display === 'none';
                button.style.display = isHidden ? '' : 'none';
                // Trigger recalculation
                responsiveHeaderHelper.recalculateLayout();
            }
        }
        
        // Force initial calculation
        setTimeout(() => {
            responsiveHeaderHelper.recalculateLayout();
        }, 100);
    </script>
</body>
</html>
